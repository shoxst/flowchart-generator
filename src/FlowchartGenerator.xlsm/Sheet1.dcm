VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
END
Attribute VB_Name = "Sheet1"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Sub Run()
    Dim blocks As New Collection
    
    Set a = New TerminalBlock
    a.InnerText = "AAA"
    a.IsStart = True
    Set a.PrevBlock = New BlockBase
    a.PrevBlock.Area.Left = 100
    a.PrevBlock.Area.Bottom = 50
    blocks.Add a
    
    Set b = New ProcessBlock
    b.InnerText = "BBB"
    Set b.PrevBlock = a
    blocks.Add b
    
    Dim main As New Collection
    Dim branch As New Collection
    Dim br As New Collection

    Set f = New DecisionBlock
    f.InnerText = "FFF"
    f.MainLabel = "Yes"
    f.BranchLabel = "No"
    Set f.PrevBlock = b
    
    Set g = New ProcessBlock
    g.InnerText = "GGG"
    branch.Add g
    
    Set h = New DecisionBlock
    h.InnerText = "HHH"
    h.MainLabel = "Yes"
    h.BranchLabel = "No"
    Set h.PrevBlock = g
    
    Set i = New ProcessBlock
    i.InnerText = "III"
    br.Add i
    
    Set h.BranchBlocks = br
    branch.Add h
    
    Set d = New ProcessBlock
    d.InnerText = "DDD"
    Set d.PrevBlock = f
    main.Add d

    Set e = New ProcessBlock
    e.InnerText = "EEE"
    Set e.PrevBlock = d
    main.Add e
    
    
    Set f.MainBlocks = main
    Set f.BranchBlocks = branch
    
    blocks.Add f

    Set c = New TerminalBlock
    c.InnerText = "CCC"
    c.IsEnd = True
    Set c.PrevBlock = f
    blocks.Add c

    Dim ed As BlockBase
    For Each ed In blocks
        ed.WriteBlock
    Next
End Sub
